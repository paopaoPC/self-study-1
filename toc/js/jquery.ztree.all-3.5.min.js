!function(k){var F,G,H,I,J,K,r={},L={},t={},M={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},u=[function(a){var b=a.treeObj,c=e.event;b.bind(c.NODECREATED,function(b,c,d){j.apply(a.callback.onNodeCreated,[b,c,d])}),b.bind(c.CLICK,function(b,c,d,e,f){j.apply(a.callback.onClick,[c,d,e,f])}),b.bind(c.EXPAND,function(b,c,d){j.apply(a.callback.onExpand,[b,c,d])}),b.bind(c.COLLAPSE,function(b,c,d){j.apply(a.callback.onCollapse,[b,c,d])}),b.bind(c.ASYNC_SUCCESS,function(b,c,d,e){j.apply(a.callback.onAsyncSuccess,[b,c,d,e])}),b.bind(c.ASYNC_ERROR,function(b,c,d,e,f,g){j.apply(a.callback.onAsyncError,[b,c,d,e,f,g])})}],v=[function(a){var b=e.event;a.treeObj.unbind(b.NODECREATED).unbind(b.CLICK).unbind(b.EXPAND).unbind(b.COLLAPSE).unbind(b.ASYNC_SUCCESS).unbind(b.ASYNC_ERROR)}],w=[function(a){var b=h.getCache(a);b||(b={},h.setCache(a,b)),b.nodes=[],b.doms=[]}],x=[function(a,b,c,d,e,f){if(c){var g=h.getRoot(a),i=a.data.key.children;c.level=b,c.tId=a.treeId+"_"+ ++g.zId,c.parentTId=d?d.tId:null,c[i]&&c[i].length>0?("string"==typeof c.open&&(c.open=j.eqs(c.open,"true")),c.open=!!c.open,c.isParent=!0,c.zAsync=!0):(c.open=!1,"string"==typeof c.isParent&&(c.isParent=j.eqs(c.isParent,"true")),c.isParent=!!c.isParent,c.zAsync=!c.isParent),c.isFirstNode=e,c.isLastNode=f,c.getParentNode=function(){return h.getNodeCache(a,c.parentTId)},c.getPreNode=function(){return h.getPreNode(a,c)},c.getNextNode=function(){return h.getNextNode(a,c)},c.isAjaxing=!1,h.fixPIdKeyValue(a,c)}}],y=[function(a){var b=a.target,c=h.getSetting(a.data.treeId),d="",f=null,g="",i="",l=null,m=null,n=null;if(j.eqs(a.type,"mousedown")?i="mousedown":j.eqs(a.type,"mouseup")?i="mouseup":j.eqs(a.type,"contextmenu")?i="contextmenu":j.eqs(a.type,"click")?j.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+e.id.SWITCH)?(d=(k(b).parent("li").get(0)||k(b).parentsUntil("li").parent().get(0)).id,g="switchNode"):(n=j.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+e.id.A}]))&&(d=(k(n).parent("li").get(0)||k(n).parentsUntil("li").parent().get(0)).id,g="clickNode"):j.eqs(a.type,"dblclick")&&(i="dblclick",n=j.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+e.id.A}]))&&(d=(k(n).parent("li").get(0)||k(n).parentsUntil("li").parent().get(0)).id,g="switchNode"),i.length>0&&0==d.length&&(n=j.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+e.id.A}]))&&(d=(k(n).parent("li").get(0)||k(n).parentsUntil("li").parent().get(0)).id),d.length>0)switch(f=h.getNodeCache(c,d),g){case"switchNode":f.isParent&&(j.eqs(a.type,"click")||j.eqs(a.type,"dblclick")&&j.apply(c.view.dblClickExpand,[c.treeId,f],c.view.dblClickExpand))?l=F:g="";break;case"clickNode":l=G}switch(i){case"mousedown":m=H;break;case"mouseup":m=I;break;case"dblclick":m=J;break;case"contextmenu":m=K}return{stop:!1,node:f,nodeEventType:g,nodeEventCallback:l,treeEventType:i,treeEventCallback:m}}],z=[function(a){var b=h.getRoot(a);b||(b={},h.setRoot(a,b)),b[a.data.key.children]=[],b.expandTriggerFlag=!1,b.curSelectedList=[],b.noSelection=!0,b.createdNodes=[],b.zId=0,b._ver=(new Date).getTime()}],A=[],B=[],C=[],D=[],E=[],h={addNodeCache:function(a,b){h.getCache(a).nodes[h.getNodeCacheId(b.tId)]=b},getNodeCacheId:function(a){return a.substring(a.lastIndexOf("_")+1)},addAfterA:function(a){B.push(a)},addBeforeA:function(a){A.push(a)},addInnerAfterA:function(a){D.push(a)},addInnerBeforeA:function(a){C.push(a)},addInitBind:function(a){u.push(a)},addInitUnBind:function(a){v.push(a)},addInitCache:function(a){w.push(a)},addInitNode:function(a){x.push(a)},addInitProxy:function(a){y.push(a)},addInitRoot:function(a){z.push(a)},addNodesData:function(a,b,c){var d=a.data.key.children;b[d]||(b[d]=[]),b[d].length>0&&(b[d][b[d].length-1].isLastNode=!1,i.setNodeLineIcos(a,b[d][b[d].length-1])),b.isParent=!0,b[d]=b[d].concat(c)},addSelectedNode:function(a,b){var c=h.getRoot(a);h.isSelectedNode(a,b)||c.curSelectedList.push(b)},addCreatedNode:function(a,b){(a.callback.onNodeCreated||a.view.addDiyDom)&&h.getRoot(a).createdNodes.push(b)},addZTreeTools:function(a){E.push(a)},exSetting:function(a){k.extend(!0,M,a)},fixPIdKeyValue:function(a,b){a.data.simpleData.enable&&(b[a.data.simpleData.pIdKey]=b.parentTId?b.getParentNode()[a.data.simpleData.idKey]:a.data.simpleData.rootPId)},getAfterA:function(a,b,c){for(var d=0,e=B.length;e>d;d++)B[d].apply(this,arguments)},getBeforeA:function(a,b,c){for(var d=0,e=A.length;e>d;d++)A[d].apply(this,arguments)},getInnerAfterA:function(a,b,c){for(var d=0,e=D.length;e>d;d++)D[d].apply(this,arguments)},getInnerBeforeA:function(a,b,c){for(var d=0,e=C.length;e>d;d++)C[d].apply(this,arguments)},getCache:function(a){return t[a.treeId]},getNextNode:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():h.getRoot(a),e=0,f=d[c].length-1;f>=e;e++)if(d[c][e]===b)return e==f?null:d[c][e+1];return null},getNodeByParam:function(a,b,c,d){if(!b||!c)return null;for(var e=a.data.key.children,f=0,g=b.length;g>f;f++){if(b[f][c]==d)return b[f];var i=h.getNodeByParam(a,b[f][e],c,d);if(i)return i}return null},getNodeCache:function(a,b){if(!b)return null;var c=t[a.treeId].nodes[h.getNodeCacheId(b)];return c?c:null},getNodeName:function(a,b){return""+b[a.data.key.name]},getNodeTitle:function(a,b){return""+b[""===a.data.key.title?a.data.key.name:a.data.key.title]},getNodes:function(a){return h.getRoot(a)[a.data.key.children]},getNodesByParam:function(a,b,c,d){if(!b||!c)return[];for(var e=a.data.key.children,f=[],g=0,i=b.length;i>g;g++)b[g][c]==d&&f.push(b[g]),f=f.concat(h.getNodesByParam(a,b[g][e],c,d));return f},getNodesByParamFuzzy:function(a,b,c,d){if(!b||!c)return[];for(var e=a.data.key.children,f=[],g=0,i=b.length;i>g;g++)"string"==typeof b[g][c]&&b[g][c].indexOf(d)>-1&&f.push(b[g]),f=f.concat(h.getNodesByParamFuzzy(a,b[g][e],c,d));return f},getNodesByFilter:function(a,b,c,d,e){if(!b)return d?null:[];for(var f=a.data.key.children,g=d?null:[],i=0,k=b.length;k>i;i++){if(j.apply(c,[b[i],e],!1)){if(d)return b[i];g.push(b[i])}var l=h.getNodesByFilter(a,b[i][f],c,d,e);if(d&&l)return l;g=d?l:g.concat(l)}return g},getPreNode:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():h.getRoot(a),e=0,f=d[c].length;f>e;e++)if(d[c][e]===b)return 0==e?null:d[c][e-1];return null},getRoot:function(a){return a?L[a.treeId]:null},getSetting:function(a){return r[a]},getSettings:function(){return r},getZTreeTools:function(a){return(a=this.getRoot(this.getSetting(a)))?a.treeTools:null},initCache:function(a){for(var b=0,c=w.length;c>b;b++)w[b].apply(this,arguments)},initNode:function(a,b,c,d,e,f){for(var g=0,h=x.length;h>g;g++)x[g].apply(this,arguments)},initRoot:function(a){for(var b=0,c=z.length;c>b;b++)z[b].apply(this,arguments)},isSelectedNode:function(a,b){for(var c=h.getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)if(b===c.curSelectedList[d])return!0;return!1},removeNodeCache:function(a,b){var c=a.data.key.children;if(b[c])for(var d=0,e=b[c].length;e>d;d++)arguments.callee(a,b[c][d]);h.getCache(a).nodes[h.getNodeCacheId(b.tId)]=null},removeSelectedNode:function(a,b){for(var c=h.getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)b!==c.curSelectedList[d]&&h.getNodeCache(a,c.curSelectedList[d].tId)||(c.curSelectedList.splice(d,1),d--,e--)},setCache:function(a,b){t[a.treeId]=b},setRoot:function(a,b){L[a.treeId]=b},setZTreeTools:function(a,b){for(var c=0,d=E.length;d>c;c++)E[c].apply(this,arguments)},transformToArrayFormat:function(a,b){if(!b)return[];var c=a.data.key.children,d=[];if(j.isArray(b))for(var e=0,f=b.length;f>e;e++)d.push(b[e]),b[e][c]&&(d=d.concat(h.transformToArrayFormat(a,b[e][c])));else d.push(b),b[c]&&(d=d.concat(h.transformToArrayFormat(a,b[c])));return d},transformTozTreeFormat:function(a,b){var c,d,e=a.data.simpleData.idKey,f=a.data.simpleData.pIdKey,g=a.data.key.children;if(!e||""==e||!b)return[];if(j.isArray(b)){var h=[],i=[];for(c=0,d=b.length;d>c;c++)i[b[c][e]]=b[c];for(c=0,d=b.length;d>c;c++)i[b[c][f]]&&b[c][e]!=b[c][f]?(i[b[c][f]][g]||(i[b[c][f]][g]=[]),i[b[c][f]][g].push(b[c])):h.push(b[c]);return h}return[b]}},m={bindEvent:function(a){for(var b=0,c=u.length;c>b;b++)u[b].apply(this,arguments)},unbindEvent:function(a){for(var b=0,c=v.length;c>b;b++)v[b].apply(this,arguments)},bindTree:function(a){var b={treeId:a.treeId},a=a.treeObj;a.bind("selectstart",function(a){return a=a.srcElement.nodeName.toLowerCase(),"input"===a||"textarea"===a}).css({"-moz-user-select":"-moz-none"}),a.bind("click",b,m.proxy),a.bind("dblclick",b,m.proxy),a.bind("mouseover",b,m.proxy),a.bind("mouseout",b,m.proxy),a.bind("mousedown",b,m.proxy),a.bind("mouseup",b,m.proxy),a.bind("contextmenu",b,m.proxy)},unbindTree:function(a){a.treeObj.unbind("click",m.proxy).unbind("dblclick",m.proxy).unbind("mouseover",m.proxy).unbind("mouseout",m.proxy).unbind("mousedown",m.proxy).unbind("mouseup",m.proxy).unbind("contextmenu",m.proxy)},doProxy:function(a){for(var b=[],c=0,d=y.length;d>c;c++){var e=y[c].apply(this,arguments);if(b.push(e),e.stop)break}return b},proxy:function(a){var b=h.getSetting(a.data.treeId);if(!j.uCanDo(b,a))return!0;for(var b=m.doProxy(a),c=!0,d=0,e=b.length;e>d;d++){var f=b[d];f.nodeEventCallback&&(c=f.nodeEventCallback.apply(f,[a,f.node])&&c),f.treeEventCallback&&(c=f.treeEventCallback.apply(f,[a,f.node])&&c)}return c}};F=function(a,b){var c=h.getSetting(a.data.treeId);if(b.open){if(0==j.apply(c.callback.beforeCollapse,[c.treeId,b],!0))return!0}else if(0==j.apply(c.callback.beforeExpand,[c.treeId,b],!0))return!0;return h.getRoot(c).expandTriggerFlag=!0,i.switchNode(c,b),!0},G=function(a,b){var c=h.getSetting(a.data.treeId),d=c.view.autoCancelSelected&&a.ctrlKey&&h.isSelectedNode(c,b)?0:c.view.autoCancelSelected&&a.ctrlKey&&c.view.selectedMulti?2:1;return 0==j.apply(c.callback.beforeClick,[c.treeId,b,d],!0)?!0:(0===d?i.cancelPreSelectedNode(c,b):i.selectNode(c,b,2===d),c.treeObj.trigger(e.event.CLICK,[a,c.treeId,b,d]),!0)},H=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeMouseDown,[c.treeId,b],!0)&&j.apply(c.callback.onMouseDown,[a,c.treeId,b]),!0},I=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeMouseUp,[c.treeId,b],!0)&&j.apply(c.callback.onMouseUp,[a,c.treeId,b]),!0},J=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeDblClick,[c.treeId,b],!0)&&j.apply(c.callback.onDblClick,[a,c.treeId,b]),!0},K=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeRightClick,[c.treeId,b],!0)&&j.apply(c.callback.onRightClick,[a,c.treeId,b]),"function"!=typeof c.callback.onRightClick};var j={apply:function(a,b,c){return"function"==typeof a?a.apply(N,b?b:[]):c},canAsync:function(a,b){var c=a.data.key.children;return a.async.enable&&b&&b.isParent&&!(b.zAsync||b[c]&&b[c].length>0)},clone:function(a){if(null===a)return null;var b,c=a.constructor===Array?[]:{};for(b in a)c[b]=a[b]instanceof Date?new Date(a[b].getTime()):"object"==typeof a[b]?arguments.callee(a[b]):a[b];return c},eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&e>d;d++)if(j.eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},uCanDo:function(){return!0}},i={addNodes:function(a,b,c,d){if(!a.data.keep.leaf||!b||b.isParent)if(j.isArray(c)||(c=[c]),a.data.simpleData.enable&&(c=h.transformTozTreeFormat(a,c)),b){var f=k("#"+b.tId+e.id.SWITCH),g=k("#"+b.tId+e.id.ICON),l=k("#"+b.tId+e.id.UL);b.open||(i.replaceSwitchClass(b,f,e.folder.CLOSE),i.replaceIcoClass(b,g,e.folder.CLOSE),b.open=!1,l.css({display:"none"})),h.addNodesData(a,b,c),i.createNodes(a,b.level+1,c,b),d||i.expandCollapseParentNode(a,b,!0)}else h.addNodesData(a,h.getRoot(a),c),i.createNodes(a,0,c,null)},appendNodes:function(a,b,c,d,e,f){if(!c)return[];for(var g=[],j=a.data.key.children,k=0,l=c.length;l>k;k++){var m=c[k];if(e){var n=(d?d:h.getRoot(a))[j].length==c.length&&0==k;h.initNode(a,b,m,d,n,k==c.length-1,f),h.addNodeCache(a,m)}n=[],m[j]&&m[j].length>0&&(n=i.appendNodes(a,b+1,m[j],m,e,f&&m.open)),f&&(i.makeDOMNodeMainBefore(g,a,m),i.makeDOMNodeLine(g,a,m),h.getBeforeA(a,m,g),i.makeDOMNodeNameBefore(g,a,m),h.getInnerBeforeA(a,m,g),i.makeDOMNodeIcon(g,a,m),h.getInnerAfterA(a,m,g),i.makeDOMNodeNameAfter(g,a,m),h.getAfterA(a,m,g),m.isParent&&m.open&&i.makeUlHtml(a,m,g,n.join("")),i.makeDOMNodeMainAfter(g,a,m),h.addCreatedNode(a,m))}return g},appendParentULDom:function(a,b){var c=[],d=k("#"+b.tId),f=k("#"+b.tId+e.id.UL),g=i.appendNodes(a,b.level+1,b[a.data.key.children],b,!1,!0);i.makeUlHtml(a,b,c,g.join("")),!d.get(0)&&b.parentTId&&(i.appendParentULDom(a,b.getParentNode()),d=k("#"+b.tId)),f.get(0)&&f.remove(),d.append(c.join(""))},asyncNode:function(b,a,c,d){var f,g;if(a&&!a.isParent)return j.apply(d),!1;if(a&&a.isAjaxing)return!1;if(0==j.apply(b.callback.beforeAsync,[b.treeId,a],!0))return j.apply(d),!1;a&&(a.isAjaxing=!0,k("#"+a.tId+e.id.ICON).attr({style:"","class":"button ico_loading"}));var l={};for(f=0,g=b.async.autoParam.length;a&&g>f;f++){var q=b.async.autoParam[f].split("="),n=q;q.length>1&&(n=q[1],q=q[0]),l[n]=a[q]}if(j.isArray(b.async.otherParam))for(f=0,g=b.async.otherParam.length;g>f;f+=2)l[b.async.otherParam[f]]=b.async.otherParam[f+1];else for(var m in b.async.otherParam)l[m]=b.async.otherParam[m];var o=h.getRoot(b)._ver;return k.ajax({contentType:b.async.contentType,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:l,dataType:b.async.dataType,success:function(f){if(o==h.getRoot(b)._ver){var g=[];try{g=f&&0!=f.length?"string"==typeof f?eval("("+f+")"):f:[]}catch(l){g=f}a&&(a.isAjaxing=null,a.zAsync=!0),i.setNodeLineIcos(b,a),g&&""!==g?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,g?j.clone(g):[],!!c)):i.addNodes(b,a,[],!!c),b.treeObj.trigger(e.event.ASYNC_SUCCESS,[b.treeId,a,f]),j.apply(d)}},error:function(c,d,f){o==h.getRoot(b)._ver&&(a&&(a.isAjaxing=null),i.setNodeLineIcos(b,a),b.treeObj.trigger(e.event.ASYNC_ERROR,[b.treeId,a,c,d,f]))}}),!0},cancelPreSelectedNode:function(a,b){for(var c=h.getRoot(a).curSelectedList,d=c.length-1;d>=0;d--)if((!b||b===c[d])&&(k("#"+c[d].tId+e.id.A).removeClass(e.node.CURSELECTED),b)){h.removeSelectedNode(a,b);break}b||(h.getRoot(a).curSelectedList=[])},createNodeCallback:function(a){if(a.callback.onNodeCreated||a.view.addDiyDom)for(var b=h.getRoot(a);b.createdNodes.length>0;){var c=b.createdNodes.shift();j.apply(a.view.addDiyDom,[a.treeId,c]),a.callback.onNodeCreated&&a.treeObj.trigger(e.event.NODECREATED,[a.treeId,c])}},createNodes:function(a,b,c,d){if(c&&0!=c.length){var f=h.getRoot(a),g=a.data.key.children,g=!d||d.open||!!k("#"+d[g][0].tId).get(0);f.createdNodes=[],b=i.appendNodes(a,b,c,d,!0,g),d?(d=k("#"+d.tId+e.id.UL),d.get(0)&&d.append(b.join(""))):a.treeObj.append(b.join("")),i.createNodeCallback(a)}},destroy:function(a){a&&(h.initCache(a),h.initRoot(a),m.unbindTree(a),m.unbindEvent(a),a.treeObj.empty())},expandCollapseNode:function(a,b,c,d,f){var g=h.getRoot(a),l=a.data.key.children;if(b){if(g.expandTriggerFlag){var m=f,f=function(){m&&m(),b.open?a.treeObj.trigger(e.event.EXPAND,[a.treeId,b]):a.treeObj.trigger(e.event.COLLAPSE,[a.treeId,b])};g.expandTriggerFlag=!1}if(!b.open&&b.isParent&&(!k("#"+b.tId+e.id.UL).get(0)||b[l]&&b[l].length>0&&!k("#"+b[l][0].tId).get(0))&&(i.appendParentULDom(a,b),i.createNodeCallback(a)),b.open==c)j.apply(f,[]);else{var c=k("#"+b.tId+e.id.UL),g=k("#"+b.tId+e.id.SWITCH),n=k("#"+b.tId+e.id.ICON);b.isParent?(b.open=!b.open,b.iconOpen&&b.iconClose&&n.attr("style",i.makeNodeIcoStyle(a,b)),b.open?(i.replaceSwitchClass(b,g,e.folder.OPEN),i.replaceIcoClass(b,n,e.folder.OPEN),0==d||""==a.view.expandSpeed?(c.show(),j.apply(f,[])):b[l]&&b[l].length>0?c.slideDown(a.view.expandSpeed,f):(c.show(),j.apply(f,[]))):(i.replaceSwitchClass(b,g,e.folder.CLOSE),i.replaceIcoClass(b,n,e.folder.CLOSE),0!=d&&""!=a.view.expandSpeed&&b[l]&&b[l].length>0?c.slideUp(a.view.expandSpeed,f):(c.hide(),j.apply(f,[])))):j.apply(f,[])}}else j.apply(f,[])},expandCollapseParentNode:function(a,b,c,d,e){b&&(b.parentTId?(i.expandCollapseNode(a,b,c,d),b.parentTId&&i.expandCollapseParentNode(a,b.getParentNode(),c,d,e)):i.expandCollapseNode(a,b,c,d,e))},expandCollapseSonNode:function(a,b,c,d,e){var f=h.getRoot(a),g=a.data.key.children,f=b?b[g]:f[g],g=b?!1:d,j=h.getRoot(a).expandTriggerFlag;if(h.getRoot(a).expandTriggerFlag=!1,f)for(var k=0,l=f.length;l>k;k++)f[k]&&i.expandCollapseSonNode(a,f[k],c,g);h.getRoot(a).expandTriggerFlag=j,i.expandCollapseNode(a,b,c,d,e)},makeDOMNodeIcon:function(a,b,c){var d=h.getNodeName(b,c),d=b.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");a.push("<span id='",c.tId,e.id.ICON,"' title='' treeNode",e.id.ICON," class='",i.makeNodeIcoClass(b,c),"' style='",i.makeNodeIcoStyle(b,c),"'></span><span id='",c.tId,e.id.SPAN,"'>",d,"</span>")},makeDOMNodeLine:function(a,b,c){a.push("<span id='",c.tId,e.id.SWITCH,"' title='' class='",i.makeNodeLineClass(b,c),"' treeNode",e.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(a){a.push("</li>")},makeDOMNodeMainBefore:function(a,b,c){a.push("<li id='",c.tId,"' class='level",c.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(a){a.push("</a>")},makeDOMNodeNameBefore:function(a,b,c){var d,f=h.getNodeTitle(b,c),g=i.makeNodeUrl(b,c),k=i.makeNodeFontCss(b,c),l=[];for(d in k)l.push(d,":",k[d],";");a.push("<a id='",c.tId,e.id.A,"' class='level",c.level,"' treeNode",e.id.A,' onclick="',c.click||"",'" ',null!=g&&g.length>0?"href='"+g+"'":""," target='",i.makeNodeTarget(c),"' style='",l.join(""),"'"),j.apply(b.view.showTitle,[b.treeId,c],b.view.showTitle)&&f&&a.push("title='",f.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),a.push(">")},makeNodeFontCss:function(a,b){var c=j.apply(a.view.fontCss,[a.treeId,b],a.view.fontCss);return c&&"function"!=typeof c?c:{}},makeNodeIcoClass:function(a,b){var c=["ico"];return b.isAjaxing||(c[0]=(b.iconSkin?b.iconSkin+"_":"")+c[0],b.isParent?c.push(b.open?e.folder.OPEN:e.folder.CLOSE):c.push(e.folder.DOCU)),"button "+c.join("_")},makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon;d&&c.push("background:url(",d,") 0 0 no-repeat;"),(0==a.view.showIcon||!j.apply(a.view.showIcon,[a.treeId,b],!0))&&c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(a,b){var c=[];return a.view.showLine?0==b.level&&b.isFirstNode&&b.isLastNode?c.push(e.line.ROOT):0==b.level&&b.isFirstNode?c.push(e.line.ROOTS):b.isLastNode?c.push(e.line.BOTTOM):c.push(e.line.CENTER):c.push(e.line.NOLINE),b.isParent?c.push(b.open?e.folder.OPEN:e.folder.CLOSE):c.push(e.folder.DOCU),i.makeNodeLineClassEx(b)+c.join("_")},makeNodeLineClassEx:function(a){return"button level"+a.level+" switch "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(a,b){var c=a.data.key.url;return b[c]?b[c]:null},makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,e.id.UL,"' class='level",b.level," ",i.makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>"),c.push(d),c.push("</ul>")},makeUlLineClass:function(a,b){return a.view.showLine&&!b.isLastNode?e.line.LINE:""},removeChildNodes:function(a,b){if(b){var c=a.data.key.children,d=b[c];if(d){for(var f=0,g=d.length;g>f;f++)h.removeNodeCache(a,d[f]);h.removeSelectedNode(a),delete b[c],a.data.keep.parent?k("#"+b.tId+e.id.UL).empty():(b.isParent=!1,b.open=!1,c=k("#"+b.tId+e.id.SWITCH),d=k("#"+b.tId+e.id.ICON),i.replaceSwitchClass(b,c,e.folder.DOCU),i.replaceIcoClass(b,d,e.folder.DOCU),k("#"+b.tId+e.id.UL).remove())}}},setFirstNode:function(a,b){var c=a.data.key.children;b[c].length>0&&(b[c][0].isFirstNode=!0)},setLastNode:function(a,b){var c=a.data.key.children,d=b[c].length;d>0&&(b[c][d-1].isLastNode=!0)},removeNode:function(a,b){var c=h.getRoot(a),d=a.data.key.children,f=b.parentTId?b.getParentNode():c;if(b.isFirstNode=!1,b.isLastNode=!1,b.getPreNode=function(){return null},b.getNextNode=function(){return null},h.getNodeCache(a,b.tId)){k("#"+b.tId).remove(),h.removeNodeCache(a,b),h.removeSelectedNode(a,b);for(var g=0,j=f[d].length;j>g;g++)if(f[d][g].tId==b.tId){f[d].splice(g,1);break}i.setFirstNode(a,f),i.setLastNode(a,f);var l,g=f[d].length;if(a.data.keep.parent||0!=g){if(a.view.showLine&&g>0){var m=f[d][g-1],g=k("#"+m.tId+e.id.UL),j=k("#"+m.tId+e.id.SWITCH);l=k("#"+m.tId+e.id.ICON),f==c?1==f[d].length?i.replaceSwitchClass(m,j,e.line.ROOT):(c=k("#"+f[d][0].tId+e.id.SWITCH),i.replaceSwitchClass(f[d][0],c,e.line.ROOTS),i.replaceSwitchClass(m,j,e.line.BOTTOM)):i.replaceSwitchClass(m,j,e.line.BOTTOM),g.removeClass(e.line.LINE)}}else f.isParent=!1,f.open=!1,g=k("#"+f.tId+e.id.UL),j=k("#"+f.tId+e.id.SWITCH),l=k("#"+f.tId+e.id.ICON),i.replaceSwitchClass(f,j,e.folder.DOCU),i.replaceIcoClass(f,l,e.folder.DOCU),g.css("display","none")}},replaceIcoClass:function(a,b,c){if(b&&!a.isAjaxing&&(a=b.attr("class"),void 0!=a)){switch(a=a.split("_"),c){case e.folder.OPEN:case e.folder.CLOSE:case e.folder.DOCU:a[a.length-1]=c}b.attr("class",a.join("_"))}},replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){switch(d=d.split("_"),c){case e.line.ROOT:case e.line.ROOTS:case e.line.CENTER:case e.line.BOTTOM:case e.line.NOLINE:d[0]=i.makeNodeLineClassEx(a)+c;break;case e.folder.OPEN:case e.folder.CLOSE:case e.folder.DOCU:d[1]=c}b.attr("class",d.join("_")),c!==e.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},selectNode:function(a,b,c){c||i.cancelPreSelectedNode(a),k("#"+b.tId+e.id.A).addClass(e.node.CURSELECTED),h.addSelectedNode(a,b)},setNodeFontCss:function(a,b){var c=k("#"+b.tId+e.id.A),d=i.makeNodeFontCss(a,b);d&&c.css(d)},setNodeLineIcos:function(a,b){if(b){var c=k("#"+b.tId+e.id.SWITCH),d=k("#"+b.tId+e.id.UL),f=k("#"+b.tId+e.id.ICON),g=i.makeUlLineClass(a,b);0==g.length?d.removeClass(e.line.LINE):d.addClass(g),c.attr("class",i.makeNodeLineClass(a,b)),b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled"),f.removeAttr("style"),f.attr("style",i.makeNodeIcoStyle(a,b)),f.attr("class",i.makeNodeIcoClass(a,b))}},setNodeName:function(a,b){var c=h.getNodeTitle(a,b),d=k("#"+b.tId+e.id.SPAN);d.empty(),a.view.nameIsHTML?d.html(h.getNodeName(a,b)):d.text(h.getNodeName(a,b)),j.apply(a.view.showTitle,[a.treeId,b],a.view.showTitle)&&k("#"+b.tId+e.id.A).attr("title",c?c:"")},setNodeTarget:function(a){k("#"+a.tId+e.id.A).attr("target",i.makeNodeTarget(a))},setNodeUrl:function(a,b){var c=k("#"+b.tId+e.id.A),d=i.makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",d)},switchNode:function(a,b){b.open||!j.canAsync(a,b)?i.expandCollapseNode(a,b,!b.open):a.async.enable?i.asyncNode(a,b)||i.expandCollapseNode(a,b,!b.open):b&&i.expandCollapseNode(a,b,!b.open)}};k.fn.zTree={consts:{event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:m,data:h},getZTreeObj:function(a){return(a=h.getZTreeTools(a))?a:null},destroy:function(a){if(a&&a.length>0)i.destroy(h.getSetting(a));else for(var b in r)i.destroy(r[b])},init:function(a,b,c){var d=j.clone(M);return k.extend(!0,d,b),d.treeId=a.attr("id"),d.treeObj=a,d.treeObj.empty(),r[d.treeId]=d,"undefined"==typeof document.body.style.maxHeight&&(d.view.expandSpeed=""),h.initRoot(d),a=h.getRoot(d),b=d.data.key.children,c=c?j.clone(j.isArray(c)?c:[c]):[],a[b]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c,h.initCache(d),m.unbindTree(d),m.bindTree(d),m.unbindEvent(d),m.bindEvent(d),c={setting:d,addNodes:function(a,b,c){function e(){i.addNodes(d,a,f,1==c)}if(!b)return null;if(a||(a=null),a&&!a.isParent&&d.data.keep.leaf)return null;var f=j.clone(j.isArray(b)?b:[b]);return j.canAsync(d,a)?i.asyncNode(d,a,c,e):e(),f},cancelSelectedNode:function(a){i.cancelPreSelectedNode(this.setting,a)},destroy:function(){i.destroy(this.setting)},expandAll:function(a){return a=!!a,i.expandCollapseSonNode(this.setting,null,a,!0),a},expandNode:function(a,b,c,e,f){if(!a||!a.isParent)return null;if(b!==!0&&b!==!1&&(b=!a.open),(f=!!f)&&b&&0==j.apply(d.callback.beforeExpand,[d.treeId,a],!0))return null;if(f&&!b&&0==j.apply(d.callback.beforeCollapse,[d.treeId,a],!0))return null;if(b&&a.parentTId&&i.expandCollapseParentNode(this.setting,a.getParentNode(),b,!1),b===a.open&&!c)return null;if(h.getRoot(d).expandTriggerFlag=f,c)i.expandCollapseSonNode(this.setting,a,b,!0,function(){if(e!==!1)try{k("#"+a.tId).focus().blur()}catch(b){}});else if(a.open=!b,i.switchNode(this.setting,a),e!==!1)try{k("#"+a.tId).focus().blur()}catch(g){}return b},getNodes:function(){return h.getNodes(this.setting)},getNodeByParam:function(a,b,c){return a?h.getNodeByParam(this.setting,c?c[this.setting.data.key.children]:h.getNodes(this.setting),a,b):null},getNodeByTId:function(a){return h.getNodeCache(this.setting,a)},getNodesByParam:function(a,b,c){return a?h.getNodesByParam(this.setting,c?c[this.setting.data.key.children]:h.getNodes(this.setting),a,b):null},getNodesByParamFuzzy:function(a,b,c){return a?h.getNodesByParamFuzzy(this.setting,c?c[this.setting.data.key.children]:h.getNodes(this.setting),a,b):null},getNodesByFilter:function(a,b,c,d){return b=!!b,a&&"function"==typeof a?h.getNodesByFilter(this.setting,c?c[this.setting.data.key.children]:h.getNodes(this.setting),a,b,d):b?null:[]},getNodeIndex:function(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(this.setting),e=0,f=c[b].length;f>e;e++)if(c[b][e]==a)return e;return-1},getSelectedNodes:function(){for(var a=[],b=h.getRoot(this.setting).curSelectedList,c=0,d=b.length;d>c;c++)a.push(b[c]);return a},isSelectedNode:function(a){return h.isSelectedNode(this.setting,a)},reAsyncChildNodes:function(a,b,c){if(this.setting.async.enable){var f=!a;if(f&&(a=h.getRoot(this.setting)),"refresh"==b){for(var b=this.setting.data.key.children,g=0,j=a[b]?a[b].length:0;j>g;g++)h.removeNodeCache(d,a[b][g]);h.removeSelectedNode(d),a[b]=[],f?this.setting.treeObj.empty():k("#"+a.tId+e.id.UL).empty()}i.asyncNode(this.setting,f?null:a,!!c)}},refresh:function(){this.setting.treeObj.empty();var a=h.getRoot(this.setting),b=a[this.setting.data.key.children];h.initRoot(this.setting),a[this.setting.data.key.children]=b,h.initCache(this.setting),i.createNodes(this.setting,0,a[this.setting.data.key.children])},removeChildNodes:function(a){if(!a)return null;var b=a[d.data.key.children];return i.removeChildNodes(d,a),b?b:null},removeNode:function(a,b){a&&(b=!!b,b&&0==j.apply(d.callback.beforeRemove,[d.treeId,a],!0)||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(e.event.REMOVE,[d.treeId,a])))},selectNode:function(a,b){if(a&&j.uCanDo(this.setting)){if(b=d.view.selectedMulti&&b,a.parentTId)i.expandCollapseParentNode(this.setting,a.getParentNode(),!0,!1,function(){try{k("#"+a.tId).focus().blur()}catch(b){}});else try{k("#"+a.tId).focus().blur()}catch(c){}i.selectNode(this.setting,a,b)}},transformTozTreeNodes:function(a){return h.transformTozTreeFormat(this.setting,a)},transformToArray:function(a){return h.transformToArrayFormat(this.setting,a)},updateNode:function(a){a&&k("#"+a.tId).get(0)&&j.uCanDo(this.setting)&&(i.setNodeName(this.setting,a),i.setNodeTarget(a),i.setNodeUrl(this.setting,a),i.setNodeLineIcos(this.setting,a),i.setNodeFontCss(this.setting,a))}},a.treeTools=c,h.setZTreeTools(d,c),a[b]&&a[b].length>0?i.createNodes(d,0,a[b]):d.async.enable&&d.async.url&&""!==d.async.url&&i.asyncNode(d),c}};var N=k.fn.zTree,e=N.consts}(jQuery),function(a){var b,c,d,e={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},f={check:{enable:!1,autoCheckTrigger:!1,chkStyle:e.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:e.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};b=function(b,c){if(c.chkDisabled===!0)return!1;var d=j.getSetting(b.data.treeId),e=d.data.key.checked;return 0==g.apply(d.callback.beforeCheck,[d.treeId,c],!0)?!0:(c[e]=!c[e],i.checkNodeRelation(d,c),e=a("#"+c.tId+h.id.CHECK),i.setChkClass(d,e,c),i.repairParentChkClassWithSelf(d,c),d.treeObj.trigger(h.event.CHECK,[b,d.treeId,c]),!0)},c=function(b,c){if(c.chkDisabled===!0)return!1;var d=j.getSetting(b.data.treeId),e=a("#"+c.tId+h.id.CHECK);return c.check_Focus=!0,i.setChkClass(d,e,c),!0},d=function(b,c){if(c.chkDisabled===!0)return!1;var d=j.getSetting(b.data.treeId),e=a("#"+c.tId+h.id.CHECK);return c.check_Focus=!1,i.setChkClass(d,e,c),!0},a.extend(!0,a.fn.zTree.consts,e),a.extend(!0,a.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(b,c){var d,e,f,g=b.data.key.children,k=b.data.key.checked;if(d=h.radio,b.check.chkStyle==d.STYLE){var l=j.getRadioCheckedList(b);if(c[k])if(b.check.radioType==d.TYPE_ALL){for(e=l.length-1;e>=0;e--)d=l[e],d[k]=!1,l.splice(e,1),i.setChkClass(b,a("#"+d.tId+h.id.CHECK),d),d.parentTId!=c.parentTId&&i.repairParentChkClassWithSelf(b,d);l.push(c)}else for(l=c.parentTId?c.getParentNode():j.getRoot(b),e=0,f=l[g].length;f>e;e++)d=l[g][e],d[k]&&d!=c&&(d[k]=!1,i.setChkClass(b,a("#"+d.tId+h.id.CHECK),d));else if(b.check.radioType==d.TYPE_ALL)for(e=0,f=l.length;f>e;e++)if(c==l[e]){l.splice(e,1);break}}else c[k]&&(!c[g]||0==c[g].length||b.check.chkboxType.Y.indexOf("s")>-1)&&i.setSonNodeCheckBox(b,c,!0),!c[k]&&(!c[g]||0==c[g].length||b.check.chkboxType.N.indexOf("s")>-1)&&i.setSonNodeCheckBox(b,c,!1),c[k]&&b.check.chkboxType.Y.indexOf("p")>-1&&i.setParentNodeCheckBox(b,c,!0),!c[k]&&b.check.chkboxType.N.indexOf("p")>-1&&i.setParentNodeCheckBox(b,c,!1)},makeChkClass:function(a,b){var c=a.data.key.checked,d=h.checkbox,e=h.radio,f="",f=b.chkDisabled===!0?d.DISABLED:b.halfCheck?d.PART:a.check.chkStyle==e.STYLE?b.check_Child_State<1?d.FULL:d.PART:b[c]?2===b.check_Child_State||-1===b.check_Child_State?d.FULL:d.PART:b.check_Child_State<1?d.FULL:d.PART,c=a.check.chkStyle+"_"+(b[c]?d.TRUE:d.FALSE)+"_"+f,c=b.check_Focus&&b.chkDisabled!==!0?c+"_"+d.FOCUS:c;return"button "+d.DEFAULT+" "+c},repairAllChk:function(a,b){if(a.check.enable&&a.check.chkStyle===h.checkbox.STYLE)for(var c=a.data.key.checked,d=a.data.key.children,e=j.getRoot(a),f=0,g=e[d].length;g>f;f++){var k=e[d][f];k.nocheck!==!0&&k.chkDisabled!==!0&&(k[c]=b),i.setSonNodeCheckBox(a,k,b)}},repairChkClass:function(b,c){if(c&&(j.makeChkFlag(b,c),c.nocheck!==!0)){var d=a("#"+c.tId+h.id.CHECK);i.setChkClass(b,d,c)}},repairParentChkClass:function(a,b){if(b&&b.parentTId){var c=b.getParentNode();i.repairChkClass(a,c),i.repairParentChkClass(a,c)}},repairParentChkClassWithSelf:function(a,b){if(b){var c=a.data.key.children;b[c]&&b[c].length>0?i.repairParentChkClass(a,b[c][0]):i.repairParentChkClass(a,b)}},repairSonChkDisabled:function(a,b,c,d){if(b){var e=a.data.key.children;if(b.chkDisabled!=c&&(b.chkDisabled=c),
i.repairChkClass(a,b),b[e]&&d)for(var f=0,g=b[e].length;g>f;f++)i.repairSonChkDisabled(a,b[e][f],c,d)}},repairParentChkDisabled:function(a,b,c,d){b&&(b.chkDisabled!=c&&d&&(b.chkDisabled=c),i.repairChkClass(a,b),i.repairParentChkDisabled(a,b.getParentNode(),c,d))},setChkClass:function(a,b,c){b&&(c.nocheck===!0?b.hide():b.show(),b.removeClass(),b.addClass(i.makeChkClass(a,c)))},setParentNodeCheckBox:function(b,c,d,e){var f=b.data.key.children,g=b.data.key.checked,k=a("#"+c.tId+h.id.CHECK);if(e||(e=c),j.makeChkFlag(b,c),c.nocheck!==!0&&c.chkDisabled!==!0&&(c[g]=d,i.setChkClass(b,k,c),b.check.autoCheckTrigger&&c!=e&&b.treeObj.trigger(h.event.CHECK,[null,b.treeId,c])),c.parentTId){if(k=!0,!d)for(var f=c.getParentNode()[f],l=0,m=f.length;m>l;l++)if(f[l].nocheck!==!0&&f[l].chkDisabled!==!0&&f[l][g]||(f[l].nocheck===!0||f[l].chkDisabled===!0)&&f[l].check_Child_State>0){k=!1;break}k&&i.setParentNodeCheckBox(b,c.getParentNode(),d,e)}},setSonNodeCheckBox:function(b,c,d,e){if(c){var f=b.data.key.children,g=b.data.key.checked,k=a("#"+c.tId+h.id.CHECK);e||(e=c);var l=!1;if(c[f])for(var m=0,n=c[f].length;n>m&&c.chkDisabled!==!0;m++){var o=c[f][m];i.setSonNodeCheckBox(b,o,d,e),o.chkDisabled===!0&&(l=!0)}c!=j.getRoot(b)&&c.chkDisabled!==!0&&(l&&c.nocheck!==!0&&j.makeChkFlag(b,c),c.nocheck!==!0&&c.chkDisabled!==!0?(c[g]=d,l||(c.check_Child_State=c[f]&&c[f].length>0?d?2:0:-1)):c.check_Child_State=-1,i.setChkClass(b,k,c),b.check.autoCheckTrigger&&c!=e&&c.nocheck!==!0&&c.chkDisabled!==!0&&b.treeObj.trigger(h.event.CHECK,[null,b.treeId,c]))}}},event:{},data:{getRadioCheckedList:function(a){for(var b=j.getRoot(a).radioCheckedList,c=0,d=b.length;d>c;c++)j.getNodeCache(a,b[c].tId)||(b.splice(c,1),c--,d--);return b},getCheckStatus:function(a,b){if(!a.check.enable||b.nocheck||b.chkDisabled)return null;var c=a.data.key.checked;return{checked:b[c],half:b.halfCheck?b.halfCheck:a.check.chkStyle==h.radio.STYLE?2===b.check_Child_State:b[c]?b.check_Child_State>-1&&b.check_Child_State<2:b.check_Child_State>0}},getTreeCheckedNodes:function(a,b,c,d){if(!b)return[];for(var e=a.data.key.children,f=a.data.key.checked,g=c&&a.check.chkStyle==h.radio.STYLE&&a.check.radioType==h.radio.TYPE_ALL,d=d?d:[],i=0,k=b.length;k>i&&(b[i].nocheck===!0||b[i].chkDisabled===!0||b[i][f]!=c||(d.push(b[i]),!g))&&(j.getTreeCheckedNodes(a,b[i][e],c,d),!(g&&d.length>0));i++);return d},getTreeChangeCheckedNodes:function(a,b,c){if(!b)return[];for(var d=a.data.key.children,e=a.data.key.checked,c=c?c:[],f=0,g=b.length;g>f;f++)b[f].nocheck!==!0&&b[f].chkDisabled!==!0&&b[f][e]!=b[f].checkedOld&&c.push(b[f]),j.getTreeChangeCheckedNodes(a,b[f][d],c);return c},makeChkFlag:function(a,b){if(b){var c=a.data.key.children,d=a.data.key.checked,e=-1;if(b[c])for(var f=0,g=b[c].length;g>f;f++){var i=b[c][f],j=-1;if(a.check.chkStyle==h.radio.STYLE){if(j=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?2:i[d]?2:i.check_Child_State>0?2:0,2==j){e=2;break}0==j&&(e=0)}else if(a.check.chkStyle==h.checkbox.STYLE){if(j=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?1:i[d]?-1===i.check_Child_State||2===i.check_Child_State?2:1:i.check_Child_State>0?1:0,1===j){e=1;break}if(2===j&&e>-1&&f>0&&j!==e){e=1;break}if(2===e&&j>-1&&2>j){e=1;break}j>-1&&(e=j)}}b.check_Child_State=e}}}});var e=a.fn.zTree,g=e._z.tools,h=e.consts,i=e._z.view,j=e._z.data;j.exSetting(f),j.addInitBind(function(a){a.treeObj.bind(h.event.CHECK,function(b,c,d,e){g.apply(a.callback.onCheck,[c?c:b,d,e])})}),j.addInitUnBind(function(a){a.treeObj.unbind(h.event.CHECK)}),j.addInitCache(function(){}),j.addInitNode(function(a,b,c,d){c&&(b=a.data.key.checked,"string"==typeof c[b]&&(c[b]=g.eqs(c[b],"true")),c[b]=!!c[b],c.checkedOld=c[b],"string"==typeof c.nocheck&&(c.nocheck=g.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||a.check.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=g.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||a.check.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=g.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return j.getCheckStatus(a,c)})}),j.addInitProxy(function(a){var e=a.target,f=j.getSetting(a.data.treeId),i="",k=null,l="",m=null;if(g.eqs(a.type,"mouseover")?f.check.enable&&g.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+h.id.CHECK)&&(i=e.parentNode.id,l="mouseoverCheck"):g.eqs(a.type,"mouseout")?f.check.enable&&g.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+h.id.CHECK)&&(i=e.parentNode.id,l="mouseoutCheck"):g.eqs(a.type,"click")&&f.check.enable&&g.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+h.id.CHECK)&&(i=e.parentNode.id,l="checkNode"),i.length>0)switch(k=j.getNodeCache(f,i),l){case"checkNode":m=b;break;case"mouseoverCheck":m=c;break;case"mouseoutCheck":m=d}return{stop:!1,node:k,nodeEventType:l,nodeEventCallback:m,treeEventType:"",treeEventCallback:null}}),j.addInitRoot(function(a){j.getRoot(a).radioCheckedList=[]}),j.addBeforeA(function(a,b,c){var d=a.data.key.checked;a.check.enable&&(j.makeChkFlag(a,b),a.check.chkStyle==h.radio.STYLE&&a.check.radioType==h.radio.TYPE_ALL&&b[d]&&j.getRoot(a).radioCheckedList.push(b),c.push("<span ID='",b.tId,h.id.CHECK,"' class='",i.makeChkClass(a,b),"' treeNode",h.id.CHECK,b.nocheck===!0?" style='display:none;'":"","></span>"))}),j.addZTreeTools(function(b,c){c.checkNode=function(c,d,e,f){var j=this.setting.data.key.checked;c.chkDisabled===!0||(d!==!0&&d!==!1&&(d=!c[j]),f=!!f,c[j]===d&&!e||f&&0==g.apply(this.setting.callback.beforeCheck,[this.setting.treeId,c],!0)||!g.uCanDo(this.setting)||!this.setting.check.enable||c.nocheck===!0)||(c[j]=d,d=a("#"+c.tId+h.id.CHECK),(e||this.setting.check.chkStyle===h.radio.STYLE)&&i.checkNodeRelation(this.setting,c),i.setChkClass(this.setting,d,c),i.repairParentChkClassWithSelf(this.setting,c),f&&b.treeObj.trigger(h.event.CHECK,[null,b.treeId,c]))},c.checkAllNodes=function(a){i.repairAllChk(this.setting,!!a)},c.getCheckedNodes=function(a){var c=this.setting.data.key.children;return j.getTreeCheckedNodes(this.setting,j.getRoot(b)[c],a!==!1)},c.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return j.getTreeChangeCheckedNodes(this.setting,j.getRoot(b)[a])},c.setChkDisabled=function(a,b,c,d){b=!!b,c=!!c,i.repairSonChkDisabled(this.setting,a,b,!!d),i.repairParentChkDisabled(this.setting,a.getParentNode(),b,c)};var d=c.updateNode;c.updateNode=function(b,e){if(d&&d.apply(c,arguments),b&&this.setting.check.enable&&a("#"+b.tId).get(0)&&g.uCanDo(this.setting)){var f=a("#"+b.tId+h.id.CHECK);(1==e||this.setting.check.chkStyle===h.radio.STYLE)&&i.checkNodeRelation(this.setting,b),i.setChkClass(this.setting,f,b),i.repairParentChkClassWithSelf(this.setting,b)}}});var k=i.createNodes;i.createNodes=function(a,b,c,d){k&&k.apply(i,arguments),c&&i.repairParentChkClassWithSelf(a,d)};var l=i.removeNode;i.removeNode=function(a,b){var c=b.getParentNode();l&&l.apply(i,arguments),b&&c&&(i.repairChkClass(a,c),i.repairParentChkClass(a,c))};var m=i.appendNodes;i.appendNodes=function(a,b,c,d,e,f){var g="";return m&&(g=m.apply(i,arguments)),d&&j.makeChkFlag(a,d),g}}(jQuery),function(a){var b={event:{DRAG:"ztree_drag",DROP:"ztree_drop",REMOVE:"ztree_remove",RENAME:"ztree_rename"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},c={onHoverOverNode:function(a,b){var d=h.getSetting(a.data.treeId),e=h.getRoot(d);e.curHoverNode!=b&&c.onHoverOutNode(a),e.curHoverNode=b,g.addHoverDom(d,b)},onHoverOutNode:function(a){var a=h.getSetting(a.data.treeId),b=h.getRoot(a);b.curHoverNode&&!h.isSelectedNode(a,b.curHoverNode)&&(g.removeTreeDom(a,b.curHoverNode),b.curHoverNode=null)},onMousedownNode:function(c,d){function i(c){if(0==o.dragFlag&&Math.abs(E-c.clientX)<n.edit.drag.minMoveSize&&Math.abs(F-c.clientY)<n.edit.drag.minMoveSize)return!0;var d,i,k,l,m;if(m=n.data.key.children,a("body").css("cursor","pointer"),0==o.dragFlag){if(0==e.apply(n.callback.beforeDrag,[n.treeId,r],!0))return j(c),!0;for(d=0,i=r.length;i>d;d++)0==d&&(o.dragNodeShowBefore=[]),k=r[d],k.isParent&&k.open?(g.expandCollapseNode(n,k,!k.open),o.dragNodeShowBefore[k.tId]=!0):o.dragNodeShowBefore[k.tId]=!1;if(o.dragFlag=1,o.showHoverDom=!1,e.showIfameMask(n,!0),k=!0,l=-1,r.length>1){var p=r[0].parentTId?r[0].getParentNode()[m]:h.getNodes(n);for(m=[],d=0,i=p.length;i>d;d++)if(void 0!==o.dragNodeShowBefore[p[d].tId]&&(k&&l>-1&&l+1!==d&&(k=!1),m.push(p[d]),l=d),r.length===m.length){r=m;break}}for(k&&(v=r[0].getPreNode(),w=r[r.length-1].getNextNode()),s=a("<ul class='zTreeDragUL'></ul>"),d=0,i=r.length;i>d;d++)if(k=r[d],k.editNameFlag=!1,g.selectNode(n,k,d>0),g.removeTreeDom(n,k),l=a("<li id='"+k.tId+"_tmp'></li>"),l.append(a("#"+k.tId+f.id.A).clone()),l.css("padding","0"),l.children("#"+k.tId+f.id.A).removeClass(f.node.CURSELECTED),s.append(l),d==n.edit.drag.maxShowNodeNum-1){l=a("<li id='"+k.tId+"_moretmp'><a>  ...  </a></li>"),s.append(l);break}s.attr("id",r[0].tId+f.id.UL+"_tmp"),s.addClass(n.treeObj.attr("class")),s.appendTo("body"),t=a("<span class='tmpzTreeMove_arrow'></span>"),t.attr("id","zTreeMove_arrow_tmp"),t.appendTo("body"),n.treeObj.trigger(f.event.DRAG,[c,n.treeId,r])}if(1==o.dragFlag){u&&t.attr("id")==c.target.id&&C&&c.clientX+x.scrollLeft()+2>a("#"+C+f.id.A,u).offset().left?(k=a("#"+C+f.id.A,u),c.target=k.length>0?k.get(0):c.target):u&&(u.removeClass(f.node.TMPTARGET_TREE),C&&a("#"+C+f.id.A,u).removeClass(f.node.TMPTARGET_NODE+"_"+f.move.TYPE_PREV).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER)),C=u=null,y=!1,z=n,k=h.getSettings();for(var q in k)k[q].treeId&&k[q].edit.enable&&k[q].treeId!=n.treeId&&(c.target.id==k[q].treeId||a(c.target).parents("#"+k[q].treeId).length>0)&&(y=!0,z=k[q]);q=x.scrollTop(),l=x.scrollLeft(),m=z.treeObj.offset(),d=z.treeObj.get(0).scrollHeight,k=z.treeObj.get(0).scrollWidth,i=c.clientY+q-m.top;var H=z.treeObj.height()+m.top-c.clientY-q,I=c.clientX+l-m.left,J=z.treeObj.width()+m.left-c.clientX-l;m=i<n.edit.drag.borderMax&&i>n.edit.drag.borderMin;var p=H<n.edit.drag.borderMax&&H>n.edit.drag.borderMin,K=I<n.edit.drag.borderMax&&I>n.edit.drag.borderMin,L=J<n.edit.drag.borderMax&&J>n.edit.drag.borderMin,H=i>n.edit.drag.borderMin&&H>n.edit.drag.borderMin&&I>n.edit.drag.borderMin&&J>n.edit.drag.borderMin,I=m&&z.treeObj.scrollTop()<=0,J=p&&z.treeObj.scrollTop()+z.treeObj.height()+10>=d,M=K&&z.treeObj.scrollLeft()<=0,N=L&&z.treeObj.scrollLeft()+z.treeObj.width()+10>=k;if(c.target.id&&z.treeObj.find("#"+c.target.id).length>0){for(var O=c.target;O&&O.tagName&&!e.eqs(O.tagName,"li")&&O.id!=z.treeId;)O=O.parentNode;var P=!0;for(d=0,i=r.length;i>d;d++){if(k=r[d],O.id===k.tId){P=!1;break}if(a("#"+k.tId).find("#"+O.id).length>0){P=!1;break}}P&&c.target.id&&(c.target.id==O.id+f.id.A||a(c.target).parents("#"+O.id+f.id.A).length>0)&&(u=a(O),C=O.id)}if(k=r[0],H&&(c.target.id==z.treeId||a(c.target).parents("#"+z.treeId).length>0)&&(!u&&(c.target.id==z.treeId||I||J||M||N)&&(y||!y&&k.parentTId)&&(u=z.treeObj),m?z.treeObj.scrollTop(z.treeObj.scrollTop()-10):p&&z.treeObj.scrollTop(z.treeObj.scrollTop()+10),K?z.treeObj.scrollLeft(z.treeObj.scrollLeft()-10):L&&z.treeObj.scrollLeft(z.treeObj.scrollLeft()+10),u&&u!=z.treeObj&&u.offset().left<z.treeObj.offset().left&&z.treeObj.scrollLeft(z.treeObj.scrollLeft()+u.offset().left-z.treeObj.offset().left)),s.css({top:c.clientY+q+3+"px",left:c.clientX+l+3+"px"}),m=d=0,u&&u.attr("id")!=z.treeId){var Q=null==C?null:h.getNodeCache(z,C);i=c.ctrlKey&&n.edit.drag.isMove&&n.edit.drag.isCopy||!n.edit.drag.isMove&&n.edit.drag.isCopy,d=!(!v||C!==v.tId),m=!(!w||C!==w.tId),l=k.parentTId&&k.parentTId==C,k=(i||!m)&&e.apply(z.edit.drag.prev,[z.treeId,r,Q],!!z.edit.drag.prev),d=(i||!d)&&e.apply(z.edit.drag.next,[z.treeId,r,Q],!!z.edit.drag.next),L=(i||!l)&&!(z.data.keep.leaf&&!Q.isParent)&&e.apply(z.edit.drag.inner,[z.treeId,r,Q],!!z.edit.drag.inner),k||d||L?(i=a("#"+C+f.id.A,u),m=Q.isLastNode?null:a("#"+Q.getNextNode().tId+f.id.A,u.next()),p=i.offset().top,l=i.offset().left,K=k?L?.25:d?.5:1:-1,L=d?L?.75:k?.5:0:-1,c=(c.clientY+q-p)/i.height(),(1==K||K>=c&&c>=-.2)&&k?(d=1-t.width(),m=p-t.height()/2,D=f.move.TYPE_PREV):(0==L||c>=L&&1.2>=c)&&d?(d=1-t.width(),m=null==m||Q.isParent&&Q.open?p+i.height()-t.height()/2:m.offset().top-t.height()/2,D=f.move.TYPE_NEXT):(d=5-t.width(),m=p,D=f.move.TYPE_INNER),t.css({display:"block",top:m+"px",left:l+d+"px"}),i.addClass(f.node.TMPTARGET_NODE+"_"+D),(A!=C||B!=D)&&(G=(new Date).getTime()),Q&&Q.isParent&&D==f.move.TYPE_INNER&&(c=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==Q.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===Q.tId&&(c=!1),c)&&(window.zTreeMoveTimer=setTimeout(function(){D==f.move.TYPE_INNER&&Q&&Q.isParent&&!Q.open&&(new Date).getTime()-G>z.edit.drag.autoOpenTime&&e.apply(z.callback.beforeDragOpen,[z.treeId,Q],!0)&&(g.switchNode(z,Q),z.edit.drag.autoExpandTrigger&&z.treeObj.trigger(f.event.EXPAND,[z.treeId,Q]))},z.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=Q.tId)):(u=null,C="",D=f.move.TYPE_INNER,t.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null))}else D=f.move.TYPE_INNER,u&&e.apply(z.edit.drag.inner,[z.treeId,r,null],!!z.edit.drag.inner)?u.addClass(f.node.TMPTARGET_TREE):u=null,t.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);A=C,B=D}return!1}function j(c){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),B=A=null,x.unbind("mousemove",i),x.unbind("mouseup",j),x.unbind("selectstart",k),a("body").css("cursor","auto"),u&&(u.removeClass(f.node.TMPTARGET_TREE),C&&a("#"+C+f.id.A,u).removeClass(f.node.TMPTARGET_NODE+"_"+f.move.TYPE_PREV).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER)),e.showIfameMask(n,!1),o.showHoverDom=!0,0!=o.dragFlag){o.dragFlag=0;var d,l,m;for(d=0,l=r.length;l>d;d++)m=r[d],m.isParent&&o.dragNodeShowBefore[m.tId]&&!m.open&&(g.expandCollapseNode(n,m,!m.open),delete o.dragNodeShowBefore[m.tId]);s&&s.remove(),t&&t.remove();var p=c.ctrlKey&&n.edit.drag.isMove&&n.edit.drag.isCopy||!n.edit.drag.isMove&&n.edit.drag.isCopy;if(!p&&u&&C&&r[0].parentTId&&C==r[0].parentTId&&D==f.move.TYPE_INNER&&(u=null),u){var q=null==C?null:h.getNodeCache(z,C);if(0!=e.apply(n.callback.beforeDrop,[z.treeId,r,q,D,p],!0)){var v=p?e.clone(r):r;d=function(){if(y){if(!p)for(var b=0,d=r.length;d>b;b++)g.removeNode(n,r[b]);if(D==f.move.TYPE_INNER)g.addNodes(z,q,v);else if(g.addNodes(z,q.getParentNode(),v),D==f.move.TYPE_PREV)for(b=0,d=v.length;d>b;b++)g.moveNode(z,q,v[b],D,!1);else for(b=-1,d=v.length-1;d>b;d--)g.moveNode(z,q,v[d],D,!1)}else if(p&&D==f.move.TYPE_INNER)g.addNodes(z,q,v);else if(p&&g.addNodes(z,q.getParentNode(),v),D!=f.move.TYPE_NEXT)for(b=0,d=v.length;d>b;b++)g.moveNode(z,q,v[b],D,!1);else for(b=-1,d=v.length-1;d>b;d--)g.moveNode(z,q,v[d],D,!1);for(b=0,d=v.length;d>b;b++)g.selectNode(z,v[b],b>0);a("#"+v[0].tId).focus().blur(),n.treeObj.trigger(f.event.DROP,[c,z.treeId,v,q,D,p])},D==f.move.TYPE_INNER&&e.canAsync(z,q)?g.asyncNode(z,q,!1,d):d()}}else{for(d=0,l=r.length;l>d;d++)g.selectNode(z,r[d],d>0);n.treeObj.trigger(f.event.DROP,[c,n.treeId,r,null,null,null])}}}function k(){return!1}var l,m,n=h.getSetting(c.data.treeId),o=h.getRoot(n);if(2==c.button||!n.edit.enable||!n.edit.drag.isCopy&&!n.edit.drag.isMove)return!0;var p=c.target,q=h.getRoot(n).curSelectedList,r=[];if(h.isSelectedNode(n,d))for(l=0,m=q.length;m>l;l++){if(q[l].editNameFlag&&e.eqs(p.tagName,"input")&&null!==p.getAttribute("treeNode"+f.id.INPUT))return!0;if(r.push(q[l]),r[0].parentTId!==q[l].parentTId){r=[d];break}}else r=[d];g.editNodeBlur=!0,g.cancelCurEditNode(n,null,!0);var s,t,u,v,w,x=a(document),y=!1,z=n,A=null,B=null,C=null,D=f.move.TYPE_INNER,E=c.clientX,F=c.clientY,G=(new Date).getTime();return e.uCanDo(n)&&x.bind("mousemove",i),x.bind("mouseup",j),x.bind("selectstart",k),c.preventDefault&&c.preventDefault(),!0}};a.extend(!0,a.fn.zTree.consts,b),a.extend(!0,a.fn.zTree._z,{tools:{getAbs:function(a){return a=a.getBoundingClientRect(),[a.left,a.top]},inputFocus:function(a){a.get(0)&&(a.focus(),e.setCursorPosition(a.get(0),a.val().length))},inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},showIfameMask:function(b,c){for(var d=h.getRoot(b);d.dragMaskList.length>0;)d.dragMaskList[0].remove(),d.dragMaskList.shift();if(c)for(var f=a("iframe"),g=0,i=f.length;i>g;g++){var j=f.get(g),k=e.getAbs(j),j=a("<div id='zTreeMask_"+g+"' class='zTreeMask' style='top:"+k[1]+"px; left:"+k[0]+"px; width:"+j.offsetWidth+"px; height:"+j.offsetHeight+"px;'></div>");j.appendTo("body"),d.dragMaskList.push(j)}}},view:{addEditBtn:function(b,c){if(!(c.editNameFlag||a("#"+c.tId+f.id.EDIT).length>0)&&e.apply(b.edit.showRenameBtn,[b.treeId,c],b.edit.showRenameBtn)){var d=a("#"+c.tId+f.id.A),h="<span class='button edit' id='"+c.tId+f.id.EDIT+"' title='"+e.apply(b.edit.renameTitle,[b.treeId,c],b.edit.renameTitle)+"' treeNode"+f.id.EDIT+" style='display:none;'></span>";d.append(h),a("#"+c.tId+f.id.EDIT).bind("click",function(){return e.uCanDo(b)&&0!=e.apply(b.callback.beforeEditName,[b.treeId,c],!0)?(g.editNode(b,c),!1):!1}).show()}},addRemoveBtn:function(b,c){if(!(c.editNameFlag||a("#"+c.tId+f.id.REMOVE).length>0)&&e.apply(b.edit.showRemoveBtn,[b.treeId,c],b.edit.showRemoveBtn)){var d=a("#"+c.tId+f.id.A),h="<span class='button remove' id='"+c.tId+f.id.REMOVE+"' title='"+e.apply(b.edit.removeTitle,[b.treeId,c],b.edit.removeTitle)+"' treeNode"+f.id.REMOVE+" style='display:none;'></span>";d.append(h),a("#"+c.tId+f.id.REMOVE).bind("click",function(){return e.uCanDo(b)&&0!=e.apply(b.callback.beforeRemove,[b.treeId,c],!0)?(g.removeNode(b,c),b.treeObj.trigger(f.event.REMOVE,[b.treeId,c]),!1):!1}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(a,b){h.getRoot(a).showHoverDom&&(b.isHover=!0,a.edit.enable&&(g.addEditBtn(a,b),g.addRemoveBtn(a,b)),e.apply(a.view.addHoverDom,[a.treeId,b]))},cancelCurEditNode:function(b,c){var d=h.getRoot(b),i=b.data.key.name,j=d.curEditNode;if(j){var k=d.curEditInput,l=c?c:k.val();if(!c&&e.apply(b.callback.beforeRename,[b.treeId,j,l],!0)===!1)return!1;j[i]=l?l:k.val(),c||b.treeObj.trigger(f.event.RENAME,[b.treeId,j]),a("#"+j.tId+f.id.A).removeClass(f.node.CURSELECTED_EDIT),k.unbind(),g.setNodeName(b,j),j.editNameFlag=!1,d.curEditNode=null,d.curEditInput=null,g.selectNode(b,j,!1)}return d.noSelection=!0},editNode:function(b,c){var d=h.getRoot(b);if(g.editNodeBlur=!1,h.isSelectedNode(b,c)&&d.curEditNode==c&&c.editNameFlag)setTimeout(function(){e.inputFocus(d.curEditInput)},0);else{var i=b.data.key.name;c.editNameFlag=!0,g.removeTreeDom(b,c),g.cancelCurEditNode(b),g.selectNode(b,c,!1),a("#"+c.tId+f.id.SPAN).html("<input type=text class='rename' id='"+c.tId+f.id.INPUT+"' treeNode"+f.id.INPUT+" >");var j=a("#"+c.tId+f.id.INPUT);j.attr("value",c[i]),b.edit.editNameSelectAll?e.inputSelect(j):e.inputFocus(j),j.bind("blur",function(){g.editNodeBlur||g.cancelCurEditNode(b)}).bind("keydown",function(a){"13"==a.keyCode?(g.editNodeBlur=!0,g.cancelCurEditNode(b,null,!0)):"27"==a.keyCode&&g.cancelCurEditNode(b,c[i])}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),a("#"+c.tId+f.id.A).addClass(f.node.CURSELECTED_EDIT),d.curEditInput=j,d.noSelection=!1,d.curEditNode=c}},moveNode:function(b,c,d,e,i,j){var k=h.getRoot(b),l=b.data.key.children;if(c!=d&&(!b.data.keep.leaf||!c||c.isParent||e!=f.move.TYPE_INNER)){var m=d.parentTId?d.getParentNode():k,n=null===c||c==k;n&&null===c&&(c=k),n&&(e=f.move.TYPE_INNER),k=c.parentTId?c.getParentNode():k,e!=f.move.TYPE_PREV&&e!=f.move.TYPE_NEXT&&(e=f.move.TYPE_INNER),e==f.move.TYPE_INNER&&(n?d.parentTId=null:(c.isParent||(c.isParent=!0,c.open=!!c.open,g.setNodeLineIcos(b,c)),d.parentTId=c.tId));var o;n?o=n=b.treeObj:(j||e!=f.move.TYPE_INNER?j||g.expandCollapseNode(b,c.getParentNode(),!0,!1):g.expandCollapseNode(b,c,!0,!1),n=a("#"+c.tId),o=a("#"+c.tId+f.id.UL),n.get(0)&&!o.get(0)&&(o=[],g.makeUlHtml(b,c,o,""),n.append(o.join(""))),o=a("#"+c.tId+f.id.UL));var p=a("#"+d.tId);p.get(0)?n.get(0)||p.remove():p=g.appendNodes(b,d.level,[d],null,!1,!0).join(""),o.get(0)&&e==f.move.TYPE_INNER?o.append(p):n.get(0)&&e==f.move.TYPE_PREV?n.before(p):n.get(0)&&e==f.move.TYPE_NEXT&&n.after(p);var q=-1,r=0,s=null,n=null,t=d.level;if(d.isFirstNode)q=0,m[l].length>1&&(s=m[l][1],s.isFirstNode=!0);else if(d.isLastNode)q=m[l].length-1,s=m[l][q-1],s.isLastNode=!0;else for(o=0,p=m[l].length;p>o;o++)if(m[l][o].tId==d.tId){q=o;break}if(q>=0&&m[l].splice(q,1),e!=f.move.TYPE_INNER)for(o=0,p=k[l].length;p>o;o++)k[l][o].tId==c.tId&&(r=o);e==f.move.TYPE_INNER?(c[l]||(c[l]=[]),c[l].length>0&&(n=c[l][c[l].length-1],n.isLastNode=!1),c[l].splice(c[l].length,0,d),d.isLastNode=!0,d.isFirstNode=1==c[l].length):c.isFirstNode&&e==f.move.TYPE_PREV?(k[l].splice(r,0,d),n=c,n.isFirstNode=!1,d.parentTId=c.parentTId,d.isFirstNode=!0,d.isLastNode=!1):c.isLastNode&&e==f.move.TYPE_NEXT?(k[l].splice(r+1,0,d),n=c,n.isLastNode=!1,d.parentTId=c.parentTId,d.isFirstNode=!1,d.isLastNode=!0):(e==f.move.TYPE_PREV?k[l].splice(r,0,d):k[l].splice(r+1,0,d),d.parentTId=c.parentTId,d.isFirstNode=!1,d.isLastNode=!1),h.fixPIdKeyValue(b,d),h.setSonNodeLevel(b,d.getParentNode(),d),g.setNodeLineIcos(b,d),g.repairNodeLevelClass(b,d,t),!b.data.keep.parent&&m[l].length<1?(m.isParent=!1,m.open=!1,c=a("#"+m.tId+f.id.UL),e=a("#"+m.tId+f.id.SWITCH),l=a("#"+m.tId+f.id.ICON),g.replaceSwitchClass(m,e,f.folder.DOCU),g.replaceIcoClass(m,l,f.folder.DOCU),c.css("display","none")):s&&g.setNodeLineIcos(b,s),n&&g.setNodeLineIcos(b,n),b.check&&b.check.enable&&g.repairChkClass&&(g.repairChkClass(b,m),g.repairParentChkClassWithSelf(b,m),m!=d.parent&&g.repairParentChkClassWithSelf(b,d)),j||g.expandCollapseParentNode(b,d.getParentNode(),!0,i)}},removeEditBtn:function(b){a("#"+b.tId+f.id.EDIT).unbind().remove()},removeRemoveBtn:function(b){a("#"+b.tId+f.id.REMOVE).unbind().remove()},removeTreeDom:function(a,b){b.isHover=!1,g.removeEditBtn(b),g.removeRemoveBtn(b),e.apply(a.view.removeHoverDom,[a.treeId,b])},repairNodeLevelClass:function(b,c,d){if(d!==c.level){var b=a("#"+c.tId),e=a("#"+c.tId+f.id.A),g=a("#"+c.tId+f.id.UL),d="level"+d,c="level"+c.level;b.removeClass(d),b.addClass(c),e.removeClass(d),e.addClass(c),g.removeClass(d),g.addClass(c)}}},event:{},data:{setSonNodeLevel:function(a,b,c){if(c){var d=a.data.key.children;if(c.level=b?b.level+1:0,c[d])for(var b=0,e=c[d].length;e>b;b++)c[d][b]&&h.setSonNodeLevel(a,c,c[d][b])}}}});var d=a.fn.zTree,e=d._z.tools,f=d.consts,g=d._z.view,h=d._z.data;h.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDrop:null,onRename:null}}),h.addInitBind(function(a){var b=a.treeObj,c=f.event;b.bind(c.RENAME,function(b,c,d){e.apply(a.callback.onRename,[b,c,d])}),b.bind(c.REMOVE,function(b,c,d){e.apply(a.callback.onRemove,[b,c,d])}),b.bind(c.DRAG,function(b,c,d,f){e.apply(a.callback.onDrag,[c,d,f])}),b.bind(c.DROP,function(b,c,d,f,g,h,i){e.apply(a.callback.onDrop,[c,d,f,g,h,i])})}),h.addInitUnBind(function(a){var a=a.treeObj,b=f.event;a.unbind(b.RENAME),a.unbind(b.REMOVE),a.unbind(b.DRAG),a.unbind(b.DROP)}),h.addInitCache(function(){}),h.addInitNode(function(a,b,c){c&&(c.isHover=!1,c.editNameFlag=!1)}),h.addInitProxy(function(a){var b=a.target,d=h.getSetting(a.data.treeId),g=a.relatedTarget,i="",j=null,k="",l=null,m=null;if(e.eqs(a.type,"mouseover")?(m=e.getMDom(d,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(i=m.parentNode.id,k="hoverOverNode"):e.eqs(a.type,"mouseout")?(m=e.getMDom(d,g,[{tagName:"a",attrName:"treeNode"+f.id.A}]),m||(i="remove",k="hoverOutNode")):e.eqs(a.type,"mousedown")&&(m=e.getMDom(d,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(i=m.parentNode.id,k="mousedownNode"),i.length>0)switch(j=h.getNodeCache(d,i),k){case"mousedownNode":l=c.onMousedownNode;break;case"hoverOverNode":l=c.onHoverOverNode;break;case"hoverOutNode":l=c.onHoverOutNode}return{stop:!1,node:j,nodeEventType:k,nodeEventCallback:l,treeEventType:"",treeEventCallback:null}}),h.addInitRoot(function(a){a=h.getRoot(a),a.curEditNode=null,a.curEditInput=null,a.curHoverNode=null,a.dragFlag=0,a.dragNodeShowBefore=[],a.dragMaskList=[],a.showHoverDom=!0}),h.addZTreeTools(function(b,c){c.cancelEditName=function(a){var c=h.getRoot(b),d=b.data.key.name,e=c.curEditNode;c.curEditNode&&g.cancelCurEditNode(b,a?a:e[d])},c.copyNode=function(a,c,d,h){if(!c)return null;if(a&&!a.isParent&&b.data.keep.leaf&&d===f.move.TYPE_INNER)return null;var i=e.clone(c);return a||(a=null,d=f.move.TYPE_INNER),d==f.move.TYPE_INNER?(c=function(){g.addNodes(b,a,[i],h)},e.canAsync(b,a)?g.asyncNode(b,a,h,c):c()):(g.addNodes(b,a.parentNode,[i],h),g.moveNode(b,a,i,d,!1,h)),i},c.editName=function(a){a&&a.tId&&a===h.getNodeCache(b,a.tId)&&(a.parentTId&&g.expandCollapseParentNode(b,a.getParentNode(),!0),g.editNode(b,a))},c.moveNode=function(c,d,h,i){function j(){g.moveNode(b,c,d,h,!1,i)}return d?c&&!c.isParent&&b.data.keep.leaf&&h===f.move.TYPE_INNER?null:c&&(d.parentTId==c.tId&&h==f.move.TYPE_INNER||a("#"+d.tId).find("#"+c.tId).length>0)?null:(c||(c=null),e.canAsync(b,c)?g.asyncNode(b,c,i,j):j(),d):d},c.setEditable=function(a){return b.edit.enable=a,this.refresh()}});var i=g.cancelPreSelectedNode;g.cancelPreSelectedNode=function(a,b){for(var c=h.getRoot(a).curSelectedList,d=0,e=c.length;e>d&&(b&&b!==c[d]||(g.removeTreeDom(a,c[d]),!b));d++);i&&i.apply(g,arguments)};var j=g.createNodes;g.createNodes=function(a,b,c,d){j&&j.apply(g,arguments),c&&g.repairParentChkClassWithSelf&&g.repairParentChkClassWithSelf(a,d)};var k=g.makeNodeUrl;g.makeNodeUrl=function(a,b){return a.edit.enable?null:k.apply(g,arguments)};var l=g.removeNode;g.removeNode=function(a,b){var c=h.getRoot(a);c.curEditNode===b&&(c.curEditNode=null),l&&l.apply(g,arguments)};var m=g.selectNode;g.selectNode=function(a,b,c){var d=h.getRoot(a);return h.isSelectedNode(a,b)&&d.curEditNode==b&&b.editNameFlag?!1:(m&&m.apply(g,arguments),g.addHoverDom(a,b),!0)};var n=e.uCanDo;e.uCanDo=function(a,b){var c=h.getRoot(a);return b&&(e.eqs(b.type,"mouseover")||e.eqs(b.type,"mouseout")||e.eqs(b.type,"mousedown")||e.eqs(b.type,"mouseup"))?!0:!c.curEditNode&&(n?n.apply(g,arguments):!0)}}(jQuery);